OBJETIVO
Garantir que a autenticaÃ§Ã£o funcione corretamente em DEV e PROD
usando cookies HTTP-only como Ãºnica fonte de sessÃ£o.

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
1ï¸âƒ£ AMBIENTE DEV (localhost)
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

FRONTEND
- URL: http://localhost:5173
- Todas as chamadas de API usam:
  - fetch â†’ credentials: 'include'
  - axios â†’ withCredentials: true
- Nenhum token salvo em:
  - localStorage
  - sessionStorage
  - memory fallback

BACKEND
- URL: http://localhost:3000
- Cookies configurados assim:

res.cookie('auth_token', token, {
  httpOnly: true,
  secure: false,
  sameSite: 'lax',
  path: '/',
});

CORS
- origin: 'http://localhost:5173'
- credentials: true

VITE
- Proxy configurado:
  /api â†’ http://localhost:3000

VALIDAÃ‡Ã•ES DEV
[ ] Cookie aparece no browser
[ ] /api/v1/auth/session retorna 200
[ ] Login nÃ£o redireciona para login novamente
[ ] Refresh token NÃƒO entra em loop
[ ] Tenant-Admin reconhece sessÃ£o do SaaS-Admin

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
2ï¸âƒ£ AMBIENTE PROD (domÃ­nio real)
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

FRONTEND
- URL HTTPS (ex: https://app.seusistema.com)
- Same origin ou subdomÃ­nio compatÃ­vel

BACKEND
- URL HTTPS (ex: https://api.seusistema.com)
- Cookies configurados assim:

res.cookie('auth_token', token, {
  httpOnly: true,
  secure: true,
  sameSite: 'none',
  path: '/',
});

CORS
- origin: domÃ­nio do frontend
- credentials: true

HTTPS
- ObrigatÃ³rio
- Sem HTTPS â†’ cookie NÃƒO funciona

VALIDAÃ‡Ã•ES PROD
[ ] Cookie aparece como Secure
[ ] Cookie SameSite=None
[ ] Session persiste apÃ³s refresh
[ ] Logout remove cookie
[ ] Nenhum token exposto no frontend

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
3ï¸âƒ£ REGRAS ABSOLUTAS (NUNCA QUEBRAR)
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

ğŸš« Nunca misturar:
- Cookie + Bearer Token
- Cookie + localStorage

ğŸš« Nunca:
- secure: true em DEV
- sameSite: none em HTTP
- origin: * com credentials: true

âœ… Sempre:
- Uma Ãºnica fonte de verdade: COOKIE HTTP-ONLY
- Session validada via /auth/session
- Refresh automÃ¡tico silencioso

STATUS
Se todos os itens estiverem OK â†’ AUTENTICAÃ‡ÃƒO CONFIÃVEL
